{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Arcade platform games catalog v2",
  "type": "object",
  "required": ["version", "games"],
  "properties": {
    "version": { "const": 2 },
    "games": {
      "type": "array",
      "items": { "$ref": "#/$defs/game" }
    }
  },
  "additionalProperties": false,
  "$defs": {
    "localizedString": {
      "type": "object",
      "required": ["en", "pl"],
      "properties": {
        "en": { "type": "string", "minLength": 1 },
        "pl": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    },
    "stringArray": {
      "type": "array",
      "items": { "type": "string", "minLength": 1 }
    },
    "source": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": { "enum": ["self", "distributor", "placeholder"] },
        "page": { "type": "string", "minLength": 1 },
        "embedUrl": { "type": "string", "minLength": 1 },
        "distributor": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false,
      "allOf": [
        {
          "if": { "properties": { "type": { "const": "self" } } },
          "then": { "required": ["page"] }
        },
        {
          "if": { "properties": { "type": { "const": "distributor" } } },
          "then": { "required": ["embedUrl"] }
        }
      ]
    },
    "game": {
      "type": "object",
      "required": ["id", "slug", "title", "source"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "slug": { "type": "string", "minLength": 1 },
        "title": { "$ref": "#/$defs/localizedString" },
        "description": { "$ref": "#/$defs/localizedString" },
        "category": { "$ref": "#/$defs/stringArray" },
        "tags": { "$ref": "#/$defs/stringArray" },
        "thumbnail": { "type": "string", "minLength": 1 },
        "orientation": { "enum": ["portrait", "landscape", "any"] },
        "source": { "$ref": "#/$defs/source" }
      },
      "additionalProperties": false
    }
  }
}
